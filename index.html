<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>GD-INSIGHT - Web Components Playground</title>
    <script type="module" src="https://euce1.anywhere.gooddata.com/components/d9040fc7d136496cb22328677a9ec87f.js?auth=sso"></script>
</head>
<body>
    <menu>
        <a href="./index.html">gd-insight</a>
        <a href="./dashboard.html">gd-dashboard</a>
        <a href="./local.html">http://localhost:3000</a>
        <a href="./euce1.html">euce1</a>
    </menu>
    <section>
        <h2>Configure</h2>
        <p>Useful to test live updates to the chart properties.</p>
        <p><label>
            Select insight
            <select id="insight-selector">
                <option selected value="pr__6bbdc451-3228-4f1d-a1b3-3343370f143f">Pivot chart</option>
                <!-- <option value="0f1acd15-b116-4868-8596-52e8fc230f70">Pie chart</option>
                <option value="44116edb-a3c5-476c-8953-672b4597c6fa">Pivot chart</option>
                <option value="6b7a997c-84f6-418a-a0ee-d4912ff042d8">Pivot chart</option>
                <option value="3a91cb86-50a3-411e-9b17-c44bbb4a5030">Column chart</option>
                <option value="1c9bdc27-5b2d-4990-b893-8c01eb525acb">Pivot chart</option> -->
            </select>
        </label></p>
        <p><label>
            Select locale
            <select id="locale">
                <option selected value="en-US">en-US</option>
                <option value="ja-JP">ja-JP</option>
            </select>
        </label></p>
        <p><label><input type="checkbox" id="show-title"/>Show title</label></p>
        <p><label>Title override <input type="text" value="" placeholder="Keep blank to use server title" id="title" /></label></p>
    </section>
    <section>
        <h2>Result</h2>
        <gd-insight
                id="insight"
                style="height: 500px;"
                insight="98b7d1fe-8505-4f30-b3f3-d70b24e15ce0"
        ></gd-insight>
    </section>
    <section>
        <h2>Event log</h2>
        <div id="log" style="height:20em;overflow-y:auto;border:1px dotted gray;"></div>
    </section>
    <script type="module">
        const insight = document.getElementById("insight");
        const insightSelector = document.getElementById("insight-selector");
        const localeSelector = document.getElementById("locale");
        const eventLog = document.getElementById("log");
        const titleInput = document.getElementById("title");
        const titleToggle = document.getElementById("show-title");

        const updateTitle = () => {
            if (!titleToggle.checked) {
                // No title
                insight.removeAttribute("title");
                return;
            }
            if (titleInput.value) {
                // Overridden title
                insight.setAttribute("title", titleInput.value);
                return;
            }
            // Default title from server
            insight.setAttribute("title", "");
        };

        insightSelector.addEventListener("change", e => {
            insight.setAttribute("insight", e.target.value);
        });
        localeSelector.addEventListener("change", e => {
            insight.setAttribute("locale", e.target.value);
        });
        titleInput.addEventListener("change", updateTitle);
        titleToggle.addEventListener("change", updateTitle);

        // Log events
        [
            "drill", "error", "exportReady", "loadingChanged", "insightLoaded",
        ].map(eventType => {
            insight.addEventListener(eventType, e => {
                const div = document.createElement("pre");
                div.style.height = "1em";
                // div.style.whiteSpace = "nowrap";
                div.style.overflow = "hidden";
                div.style.borderBottom = "1px dashed gray";
                div.innerText = `${eventType.padEnd(20)}: ${JSON.stringify(e.detail)}`;
                eventLog.appendChild(div);

                console.log(eventType, e.detail);
            });
        });
    </script>
</body>
</html>
